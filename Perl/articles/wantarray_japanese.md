<!--
Meta Description: # wantarray: Perlにおける配列の文脈を制御する機能 ## 概要 `wantarray`は、Perlプログラミング言語における関数やメソッドの呼び出しが、スカラコンテキストで行われるか、配列コンテキストで行われるかを判断するための特別な機能です。これにより、返すべき値の形式を動的に変更...
Meta Keywords: wantarray, example, これにより, が返されます, undef
-->

# wantarray: Perlにおける配列の文脈を制御する機能

## 概要
`wantarray`は、Perlプログラミング言語における関数やメソッドの呼び出しが、スカラコンテキストで行われるか、配列コンテキストで行われるかを判断するための特別な機能です。これにより、返すべき値の形式を動的に変更することができます。

## ドキュメンテーション
`wantarray`は、現在のコンテキストがスカラ、配列、または未定義のいずれであるかを確認するための関数です。この関数を使用することで、呼び出し元が期待する戻り値の形式に基づいて、異なる値を返すことが可能になります。

### 目的
`wantarray`は、サブルーチンや関数が、呼び出し元のコンテキストに応じて異なる値を返すことを可能にします。これにより、柔軟な関数設計が実現します。

### 使用法
`wantarray`を呼び出すには、単に関数内で使用するだけです。戻り値は、現在のコンテキストに応じた値を返します。

- スカラコンテキストの場合は、`1`が返されます。
- 配列コンテキストの場合は、`undef`が返されます。
- また、呼び出しが行われていない場合、`wantarray`は`undef`を返します。

### 詳細
この機能は、特に状況に応じて異なる型のデータを返す必要がある場合に便利です。例えば、同じデータをスカラとして取得したい場合と、配列として取得したい場合に同じ関数を使用することができます。

## 例
以下は、`wantarray`を使用した基本的な例です。

```perl
sub example {
    if (wantarray) {
        return (1, 2, 3);
    } else {
        return 42;
    }
}

my @array = example();  # 配列コンテキスト
my $scalar = example();  # スカラコンテキスト

print "@array\n";  # 出力: 1 2 3
print "$scalar\n"; # 出力: 42
```

## 説明
`wantarray`を使用する際の一般的な落とし穴として、次の点に注意が必要です：

- `wantarray`は、サブルーチンの実行中にのみ使用可能であり、グローバルな文脈では機能しません。
- 自動的に返される値の型を意識する必要があります。たとえば、配列のコンテキストでスカラを返すと、意図しない動作を引き起こす可能性があります。
- 返す値の形式を明確にするために、呼び出し元のコンテキストを正確に把握することが重要です。

## 一文要約
`wantarray`は、Perlにおいて関数の呼び出し時のコンテキストに応じて異なる戻り値を制御するための重要な機能です。