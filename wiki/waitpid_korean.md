<!--
Meta Description: # Perl의 waitpid 함수: 자식 프로세스의 상태를 기다리는 방법 ## 개요 `waitpid`는 Perl에서 자식 프로세스의 종료를 기다리기 위해 사용되는 함수로, 프로세스의 종료 상태와 관련된 정보를 얻을 수 있습니다. 이 함수는 프로세스 간의 동기화를 관리하...
Meta Keywords: waitpid, 프로세스의, pid, 프로세스, 프로세스가
-->

# Perl의 waitpid 함수: 자식 프로세스의 상태를 기다리는 방법

## 개요
`waitpid`는 Perl에서 자식 프로세스의 종료를 기다리기 위해 사용되는 함수로, 프로세스의 종료 상태와 관련된 정보를 얻을 수 있습니다. 이 함수는 프로세스 간의 동기화를 관리하는 데 유용합니다.

## 문서화
### 목적
`waitpid` 함수는 지정된 자식 프로세스의 종료를 기다리며, 자식 프로세스가 종료될 때까지 현재 프로세스를 차단합니다. 이 함수는 프로세스의 PID(프로세스 ID)를 인자로 받아, 해당 프로세스의 종료 상태를 반환합니다.

### 사용법
```perl
$pid = waitpid($pid, $options);
```

- **$pid**: 기다릴 자식 프로세스의 PID입니다. -1을 전달하면 모든 자식 프로세스를 기다립니다.
- **$options**: 선택적 인자로, `WNOHANG`를 사용하면 자식 프로세스가 종료되지 않았더라도 제어를 반환합니다.

### 반환값
- 성공 시: 자식 프로세스의 PID를 반환합니다.
- 실패 시: -1을 반환하며, `$!`에 오류 코드가 설정됩니다. 

### 추가 정보
- `waitpid`는 부모 프로세스가 자식 프로세스의 종료를 처리하고, 시스템 자원을 해제하도록 합니다.
- `WIFEXITED`와 같은 매크로를 사용하여 종료 상태를 분석할 수 있습니다.

## 예제
### 기본 사용 예제
```perl
use strict;
use warnings;

my $pid = fork();

if ($pid == 0) {
    # 자식 프로세스
    sleep(2);
    exit(0);
} else {
    # 부모 프로세스
    my $child_pid = waitpid($pid, 0);
    print "자식 프로세스 ($child_pid)가 종료되었습니다.\n";
}
```

### WNOHANG 옵션 사용 예제
```perl
use strict;
use warnings;

my $pid = fork();

if ($pid == 0) {
    # 자식 프로세스
    sleep(2);
    exit(0);
} else {
    # 부모 프로세스
    while (1) {
        my $child_pid = waitpid($pid, WNOHANG);
        if ($child_pid == 0) {
            print "자식 프로세스가 아직 종료되지 않았습니다.\n";
            sleep(1);
        } elsif ($child_pid == -1) {
            print "오류 발생: $!\n";
            last;
        } else {
            print "자식 프로세스 ($child_pid)가 종료되었습니다.\n";
            last;
        }
    }
}
```

## 설명
`waitpid`를 사용할 때 주의해야 할 점은 다음과 같습니다:
- 자식 프로세스가 종료되지 않은 경우, 기본적으로 부모 프로세스는 차단됩니다. `WNOHANG` 옵션을 사용하면 차단되지 않도록 할 수 있습니다.
- PID가 -1로 설정될 경우, 부모 프로세스는 모든 자식 프로세스를 기다리게 됩니다.
- 자식 프로세스가 `fork`로 생성되지 않았거나 이미 종료된 경우, `waitpid`는 -1을 반환하며 `$!`에 적절한 오류 메시지를 설정합니다.

## 한 줄 요약
`waitpid` 함수는 Perl에서 특정 자식 프로세스의 종료를 기다리고 해당 상태를 반환하는 기능을 제공합니다.