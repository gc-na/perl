<!--
Meta Description: # Perl 中的 pack 函數：資料打包的利器 ## 摘要 `pack` 是 Perl 中用於將數據結構轉換為二進制格式的函數，常用於處理低層次的數據操作，如網絡傳輸和文件存儲。 ## 文檔 ### 目的 `pack` 函數的主要目的在於將一組數據轉換為指定格式的二進制字符串。這在需要與其他系統...
Meta Keywords: pack, perl, 255, print, 12345
-->

# Perl 中的 pack 函數：資料打包的利器

## 摘要
`pack` 是 Perl 中用於將數據結構轉換為二進制格式的函數，常用於處理低層次的數據操作，如網絡傳輸和文件存儲。

## 文檔
### 目的
`pack` 函數的主要目的在於將一組數據轉換為指定格式的二進制字符串。這在需要與其他系統進行數據交互，或在處理二進制文件時尤為重要。

### 用法
`pack` 函數的基本語法如下：

```perl
$binary_data = pack(SCALE, LIST);
```

- **SCALE**：這是格式模板，定義了如何將數據打包。常用的範本字符包括：
  - `C`：無符號字符（8 位）
  - `c`：有符號字符（8 位）
  - `S`：無符號短整數（16 位）
  - `s`：有符號短整數（16 位）
  - `L`：無符號長整數（32 位）
  - `l`：有符號長整數（32 位）
  - `f`：單精度浮點數（32 位）
  - `d`：雙精度浮點數（64 位）

- **LIST**：要打包的數據列表。

### 詳細說明
`pack` 函數支持多種格式化選項，使用者可以根據需求靈活組合。例如，`pack("CC", 255, 0)` 將生成包含兩個無符號字符的二進制字符串，其中第一個字符的值為 255，第二個為 0。

`pack` 函數的格式模板可以重複使用，例如，`pack("C*", @array)` 將把數組中的每個元素作為無符號字符打包。

## 範例
以下是幾個基本使用範例：

### 範例 1：打包無符號字符
```perl
my $data = pack("C*", 65, 66, 67); # 65, 66, 67 對應 ASCII 字符 A, B, C
print $data; # 輸出 ABC
```

### 範例 2：打包整數
```perl
my $int_data = pack("S", 12345); # 打包 12345 為 16 位無符號整數
print unpack("S", $int_data); # 輸出 12345
```

### 範例 3：打包多種類型
```perl
my $mixed_data = pack("CCf", 255, 0, 3.14); # 打包一個無符號字符、一個無符號字符和一個浮點數
print unpack("CCf", $mixed_data); # 輸出 255, 0, 3.14
```

## 解釋
使用 `pack` 函數時，有幾個常見的陷阱：

- **格式錯誤**：確保模板與數據類型匹配，否則會導致不正確的輸出或錯誤。
- **字節序**：在跨平台操作時，注意大端與小端字節序的差異，可能需要使用大寫或小寫前綴（如 `N` 和 `n`）來指定字節序。
- **數據範圍**：使用不正確的數據範圍會導致溢出，特別是在打包整數時。

## 簡短總結
`pack` 函數是 Perl 中將數據打包為二進制格式的強大工具，廣泛應用於數據傳輸和存儲。